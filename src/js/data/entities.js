/**
 * JUST IN TIME - Entity Definitions
 * NPCs, enemies, containers, and interactive objects.
 */

import { EntityType, Colors } from '../core/constants.js';

export const ENTITY_DEFS = {
  // ============================================================
  // VAULT 42 ENTITIES
  // ============================================================

  chronos_terminal: {
    id: 'chronos_terminal',
    type: EntityType.TERMINAL,
    name: 'CHRONOS Terminal',
    description: 'A flickering terminal connected to the vault\'s AI. The screen displays a suspiciously cheerful smiley face.',
    sprite: { char: 'P', fg: '#4f4', bg: '#232' },
    blocking: false,
    dialogId: 'chronos_intro',
    allies: ['security_bot'],
  },

  vault_locker_1: {
    id: 'vault_locker_1',
    type: EntityType.CONTAINER,
    name: 'Vault Locker',
    description: 'A standard-issue Vault-Tec locker. Dented but functional.',
    sprite: { char: 'K', fg: '#99a', bg: '#445' },
    blocking: true,
    items: ['pistol_10mm', 'ammo_10mm'],
  },

  vault_locker_2: {
    id: 'vault_locker_2',
    type: EntityType.CONTAINER,
    name: 'Vault Locker',
    description: 'Another locker. Someone scratched "HELP" on the inside. Classic.',
    sprite: { char: 'K', fg: '#99a', bg: '#445' },
    blocking: true,
    items: ['stimpak', 'vault_keycard'],
  },

  vault_crate: {
    id: 'vault_crate',
    type: EntityType.CONTAINER,
    name: 'Supply Crate',
    description: 'A supply crate labeled "EMERGENCY USE ONLY." Well, if being frozen for 210 years isn\'t an emergency...',
    sprite: { char: 'x', fg: '#a86', bg: '#432' },
    blocking: true,
    items: ['leather_armor', 'purified_water', 'rad_x'],
  },

  security_bot: {
    id: 'security_bot',
    type: EntityType.ENEMY,
    name: 'Malfunctioning Security Bot',
    description: 'A vault security robot that\'s clearly been through some things. Its voice module is stuck on "HAVE A NICE DAY" which it says menacingly.',
    sprite: { char: 'R', fg: '#f44', bg: '#422' },
    blocking: true,
    hostile: true,
    hp: 30,
    maxHp: 30,
    ap: 6,
    maxAp: 6,
    damage: { min: 3, max: 8 },
    accuracy: 55,
    range: 1,
    initiative: 4,
    xpReward: 50,
    loot: ['scrap_metal', 'energy_cell'],
    combatQuip: 'HAVE A NICE DAY. COMPLIANCE IS MANDATORY.',
    deathQuip: 'It sparks, sputters, and cheerfully announces "SHUTTING DOWN. HAVE A NICE DAY." as it collapses.',
    allies: ['chronos_terminal'],
  },

  // ============================================================
  // DUSTBOWL ENTITIES
  // ============================================================

  scarlett: {
    id: 'scarlett',
    type: EntityType.NPC,
    name: 'Scarlett',
    description: 'The owner of The Glowing Pint. Red hair, sharp eyes, and a smile that could either warm your heart or cut your throat. Possibly both.',
    sprite: { char: 'S', fg: Colors.NPC_FRIENDLY, bg: 'transparent' },
    blocking: true,
    dialogId: 'scarlett_intro',
    allies: ['mayor_bottlecap', 'doc_feelgood', 'rusty'],
  },

  rusty: {
    id: 'rusty',
    type: EntityType.NPC,
    name: 'Rusty',
    description: 'A robot merchant. Once a pre-war vending machine, now retrofitted with legs, arms, and an existential crisis. His prices are fair, his jokes are not.',
    sprite: { char: 'R', fg: Colors.NPC_FRIENDLY, bg: 'transparent' },
    blocking: true,
    dialogId: 'rusty_intro',
    allies: ['scarlett', 'mayor_bottlecap', 'doc_feelgood'],
  },

  mayor_bottlecap: {
    id: 'mayor_bottlecap',
    type: EntityType.NPC,
    name: 'Mayor Bottlecap',
    description: 'Gerald "Bottlecap" Morrison, self-appointed mayor of Dustbowl. Wears a suit made from pre-war curtains and a tie made from actual bottle caps. Takes his job very seriously. Nobody else does.',
    sprite: { char: 'M', fg: Colors.NPC_FRIENDLY, bg: 'transparent' },
    blocking: true,
    dialogId: 'mayor_intro',
    allies: ['scarlett', 'doc_feelgood', 'rusty'],
  },

  doc_feelgood: {
    id: 'doc_feelgood',
    type: EntityType.NPC,
    name: 'Doc Feelgood',
    description: 'The town\'s only medical professional. His real name is Harold, but everyone calls him Doc Feelgood because his bedside manner consists entirely of saying "You\'ll feel good soon" regardless of the diagnosis.',
    sprite: { char: 'D', fg: Colors.NPC_FRIENDLY, bg: 'transparent' },
    blocking: true,
    dialogId: 'doc_intro',
    allies: ['scarlett', 'mayor_bottlecap', 'rusty'],
  },

  wasteland_trader: {
    id: 'wasteland_trader',
    type: EntityType.NPC,
    name: 'Patches',
    description: 'A traveling merchant of questionable origin. Covered in patches (hence the name). Claims to have been everywhere and seen everything, and will tell you about it whether you want to hear it or not.',
    sprite: { char: 'T', fg: Colors.NPC_NEUTRAL, bg: 'transparent' },
    blocking: true,
    dialogId: 'trader_intro',
  },

  sign_bar: {
    id: 'sign_bar',
    type: EntityType.NPC,
    name: 'Sign',
    description: 'A hand-painted sign reading "THE GLOWING PINT - Drinks So Good They\'re Radioactive (literally)". Below in smaller text: "Management not responsible for mutations."',
    sprite: { char: '!', fg: '#ff4', bg: 'transparent' },
    blocking: false,
    dialogId: null,
  },

  sign_store: {
    id: 'sign_store',
    type: EntityType.NPC,
    name: 'Sign',
    description: '"RUSTY\'S GENERAL GOODS - If We Don\'t Have It, You Probably Don\'t Need It. And If You Do Need It, Tough."',
    sprite: { char: '!', fg: '#ff4', bg: 'transparent' },
    blocking: false,
    dialogId: null,
  },

  sign_entrance: {
    id: 'sign_entrance',
    type: EntityType.NPC,
    name: 'Sign',
    description: '"WELCOME TO DUSTBOWL - Population: Enough. Please leave your weapons holstered and your expectations low."',
    sprite: { char: '!', fg: '#ff4', bg: 'transparent' },
    blocking: false,
    dialogId: null,
  },

  // ============================================================
  // WASTES ENTITIES
  // ============================================================

  radroach_1: {
    id: 'radroach_1',
    type: EntityType.ENEMY,
    name: 'Radroach',
    description: 'A cockroach the size of a small dog. Radiation did this. Or maybe cockroaches were always this big and we never noticed.',
    sprite: { char: 'r', fg: '#a64', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 12,
    maxHp: 12,
    ap: 4,
    maxAp: 4,
    damage: { min: 1, max: 4 },
    accuracy: 40,
    range: 1,
    initiative: 6,
    xpReward: 15,
    loot: ['radroach_meat'],
    combatQuip: null,
    deathQuip: 'The radroach expires with a wet crunch. Delicious. (Not really.)',
  },

  radroach_2: {
    id: 'radroach_2',
    type: EntityType.ENEMY,
    name: 'Radroach',
    description: 'Another oversized roach. They travel in pairs. Like socks, except horrifying.',
    sprite: { char: 'r', fg: '#a64', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 12,
    maxHp: 12,
    ap: 4,
    maxAp: 4,
    damage: { min: 1, max: 4 },
    accuracy: 40,
    range: 1,
    initiative: 6,
    xpReward: 15,
    loot: [],
    combatQuip: null,
    deathQuip: 'Squish. At least that\'s one less radroach in the world.',
  },

  radroach_3: {
    id: 'radroach_3',
    type: EntityType.ENEMY,
    name: 'Giant Radroach',
    description: 'The alpha roach. Bigger, meaner, and somehow more disgusting than its peers.',
    sprite: { char: 'R', fg: '#c64', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 25,
    maxHp: 25,
    ap: 6,
    maxAp: 6,
    damage: { min: 3, max: 7 },
    accuracy: 50,
    range: 1,
    initiative: 5,
    xpReward: 35,
    loot: ['radroach_meat', 'stimpak'],
    combatQuip: null,
    deathQuip: 'The giant radroach collapses. Its death rattle sounds disturbingly like a burp.',
  },

  wasteland_corpse: {
    id: 'wasteland_corpse',
    type: EntityType.CONTAINER,
    name: 'Wasteland Corpse',
    description: 'A long-dead traveler. Their expression suggests they died as they lived: mildly annoyed. A note in their pocket reads "Going to Dustbowl. What could go wrong?"',
    sprite: { char: '%', fg: '#864', bg: 'transparent' },
    blocking: false,
    items: ['caps_pouch', 'dirty_water', 'wasteland_note'],
  },

  road_sign: {
    id: 'road_sign',
    type: EntityType.NPC,
    name: 'Road Sign',
    description: 'A battered road sign. One arrow points west: "VAULT 42 - AUTHORIZED PERSONNEL ONLY." Another points east: "DUSTBOWL - 2 MI." Someone has added in marker: "Good luck, you\'ll need it."',
    sprite: { char: '!', fg: '#ff4', bg: '#332' },
    blocking: false,
    dialogId: null,
  },

  // ============================================================
  // WATER TREATMENT PLANT ENTITIES
  // ============================================================

  mutant_roach_1: {
    id: 'mutant_roach_1',
    type: EntityType.ENEMY,
    name: 'Mutant Roach',
    description: 'A radroach that has absorbed enough toxic waste to mutate into something even more unpleasant. Larger, meaner, and somehow MORE disgusting than its irradiated cousins. The wasteland never stops innovating.',
    sprite: { char: 'r', fg: '#6a2', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 22,
    maxHp: 22,
    ap: 5,
    maxAp: 5,
    damage: { min: 3, max: 7 },
    accuracy: 50,
    range: 1,
    initiative: 5,
    xpReward: 25,
    loot: ['mutant_meat', 'stimpak'],
    combatQuip: null,
    deathQuip: 'The mutant roach collapses with a sound like a bag of wet gravel. Progress.',
  },

  mutant_roach_2: {
    id: 'mutant_roach_2',
    type: EntityType.ENEMY,
    name: 'Mutant Roach',
    description: 'Another toxic-waste-enhanced roach. It seems to be drooling something. You choose not to think about what.',
    sprite: { char: 'r', fg: '#6a2', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 22,
    maxHp: 22,
    ap: 5,
    maxAp: 5,
    damage: { min: 3, max: 7 },
    accuracy: 50,
    range: 1,
    initiative: 5,
    xpReward: 25,
    loot: ['mutant_meat'],
    combatQuip: null,
    deathQuip: 'It expires with surprising dignity, all things considered. The dignity, of course, is entirely in your imagination.',
  },

  mutant_roach_3: {
    id: 'mutant_roach_3',
    type: EntityType.ENEMY,
    name: 'Mutant Roach Alpha',
    description: 'The biggest mutant roach in the entry hall, distinguishable by its size, its aggressive posture, and the fact that it has what appears to be a makeshift crown fashioned from a bottle cap. Democracy is dead.',
    sprite: { char: 'R', fg: '#8c4', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 30,
    maxHp: 30,
    ap: 6,
    maxAp: 6,
    damage: { min: 4, max: 9 },
    accuracy: 55,
    range: 1,
    initiative: 4,
    xpReward: 40,
    loot: ['mutant_meat', 'stimpak'],
    combatQuip: null,
    deathQuip: 'The alpha roach falls. Its bottle cap crown clatters across the floor. You could take it. You probably shouldn\'t, but you could.',
  },

  sentry_turret_1: {
    id: 'sentry_turret_1',
    type: EntityType.ENEMY,
    name: 'Sentry Turret',
    description: 'A pre-war automated defense turret, still operational after 210 years. It tracks movement with unsettling accuracy and a distinct lack of ethical considerations. Its targeting reticle settles on you with the enthusiasm of a machine that has been very bored for two centuries.',
    sprite: { char: 'T', fg: '#f84', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 35,
    maxHp: 35,
    ap: 4,
    maxAp: 4,
    damage: { min: 5, max: 12 },
    accuracy: 70,
    range: 6,
    initiative: 2,
    xpReward: 60,
    loot: ['energy_cell', 'scrap_metal'],
    combatQuip: 'THREAT DETECTED. ENGAGING. HAVE A PRODUCTIVE DAY.',
    deathQuip: 'The turret sparks, rotates randomly, says "LOW AMMO" in a plaintive voice, and goes dark.',
    immobile: true,
  },

  sentry_turret_2: {
    id: 'sentry_turret_2',
    type: EntityType.ENEMY,
    name: 'Sentry Turret',
    description: 'A second automated turret, flanking the processing area. It\'s covered in what appears to be old graffiti reading "PLEASE TURN ME OFF." Nobody did.',
    sprite: { char: 'T', fg: '#f84', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 35,
    maxHp: 35,
    ap: 4,
    maxAp: 4,
    damage: { min: 5, max: 12 },
    accuracy: 70,
    range: 6,
    initiative: 2,
    xpReward: 60,
    loot: ['energy_cell', 'energy_cell'],
    combatQuip: 'INTRUDER DETECTED. INITIATING HOSTILE RESPONSE. SORRY IN ADVANCE.',
    deathQuip: 'With its dying spark, the turret manages one final rotation - as if looking for help that isn\'t coming - before going still.',
    immobile: true,
  },

  overflow_guardian: {
    id: 'overflow_guardian',
    type: EntityType.ENEMY,
    name: 'Overflow Guardian',
    description: 'A massive mutant creature that has made the purification chamber its home for decades. Whatever it was before - human, animal, or something in between - the toxic waste has rendered it into something uniquely terrible. It guards the water chip with territorial fury and remarkably bad breath.',
    sprite: { char: 'G', fg: '#2d8', bg: 'transparent' },
    blocking: true,
    hostile: true,
    hp: 85,
    maxHp: 85,
    ap: 6,
    maxAp: 6,
    damage: { min: 8, max: 18 },
    accuracy: 60,
    range: 1,
    initiative: 3,
    xpReward: 250,
    loot: ['stimpak', 'stimpak', 'mutant_meat'],
    combatQuip: 'The Guardian lets out a sound like a water pipe bursting. You take this as a greeting.',
    deathQuip: 'The Overflow Guardian collapses with a sound like a dam breaking. In its final moments, it seems almost relieved. Two hundred years of guarding a water chip in a derelict plant will do that.',
  },

  plant_chip_container: {
    id: 'plant_chip_container',
    type: EntityType.CONTAINER,
    name: 'Purification Control Unit',
    description: 'A sealed pre-war housing unit for the facility\'s water purification chip. Its emergency seal has kept the contents intact through two centuries of neglect, toxic waste, and one large territorial mutant.',
    sprite: { char: 'x', fg: '#4af', bg: 'transparent' },
    blocking: true,
    dialogId: 'water_chip_dialog',
  },

  control_terminal: {
    id: 'control_terminal',
    type: EntityType.TERMINAL,
    name: 'Access Control Terminal',
    description: 'A pre-war security terminal controlling access to the upper facility. The screen reads "UNAUTHORIZED ACCESS WILL BE LOGGED" - a threat rendered somewhat hollow by the 210-year absence of anyone to read the logs.',
    sprite: { char: 'P', fg: '#4f4', bg: '#232' },
    blocking: true,
    dialogId: 'control_terminal_dialog',
  },

  plant_lore_terminal: {
    id: 'plant_lore_terminal',
    type: EntityType.TERMINAL,
    name: 'Facility Records Terminal',
    description: 'A terminal containing administrative records for the water treatment plant. Someone has taped a handwritten note to it that reads "IF YOU\'RE READING THIS, THE BOMBS HAVEN\'T DROPPED YET. ENJOY YOUR CLEAN WATER WHILE IT LASTS." The tape has held for 210 years. The water has not.',
    sprite: { char: 'P', fg: '#4f4', bg: '#232' },
    blocking: true,
    dialogId: 'plant_lore_terminal_dialog',
  },

  plant_supply_crate: {
    id: 'plant_supply_crate',
    type: EntityType.CONTAINER,
    name: 'Emergency Supply Crate',
    description: 'A pre-war emergency supply crate, sealed for 210 years. The label reads "MUNICIPAL WATER AUTHORITY - EMERGENCY USE ONLY." Given the current state of municipal authority, this qualifies.',
    sprite: { char: 'x', fg: '#a86', bg: 'transparent' },
    blocking: true,
    items: ['stimpak', 'stimpak', 'rad_x', 'energy_cell'],
  },
};
